const images = [
		{
			src: "./assets/images/gallery/concerts/aaron-paul.webp",
			alt: "Foule \xe0 un concert de nuit",
			category: "Concert",
			id: "1",
		},
		{
			src: "./assets/images/gallery/entreprise/ali-morshedlou.webp",
			alt: "Homme en costume regardant l'objectif",
			category: "Entreprises",
			id: "2",
		},
		{
			src: "./assets/images/gallery/entreprise/jason-goodman.webp",
			alt: "Deux femmes assisent rigolant",
			category: "Entreprises",
			id: "3",
		},
		{
			src: "./assets/images/gallery/mariage/hannah-busing.webp",
			alt: "Gros plan sur des mains",
			category: "Mariages",
			id: "4",
		},
		{
			src: "./assets/images/gallery/portraits/ade-tunji.webp",
			alt: "Portrait d'un homme fermant les yeux",
			category: "Portrait",
			id: "5",
		},
		{
			src: "./assets/images/gallery/mariage/jakob-owens.webp",
			alt: "Deux mari\xe9s marchant joyeusement",
			category: "Mariages",
			id: "6",
		},
		{
			src: "./assets/images/gallery/portraits/nino-van-prattenburg.webp",
			alt: "Portrait d'une femme regardant vers le bas",
			category: "Portrait",
			id: "7",
		},
		{
			src: "./assets/images/gallery/concerts/austin-neill.webp",
			alt: "Chanteur sur scene avec de la fum\xe9e",
			category: "Concert",
			id: "8",
		},
		{
			src: "./assets/images/gallery/entreprise/mateus-campos-felipe.webp",
			alt: "Femme joyeuse devant un ordinateur portable",
			category: "Entreprises",
			id: "9",
		},
	],
	filters = [
		{ name: "Tous", category: "Tous" },
		{ name: "Concert", category: "Concert" },
		{ name: "Entreprises", category: "Entreprises" },
		{ name: "Mariages", category: "Mariages" },
		{ name: "Portrait", category: "Portrait" },
	],
	gallery = document.querySelector(".gallery");
let filteredImages = images;
function createFilter(e) {
	let t = document.createElement("ul");
	t.classList.add("my-4-tags-bar", "nav", "nav-pills"),
		e.forEach((e) => {
			t.innerHTML += `<li class="nav-item"><span class="nav-link active-tag" data-images-toggle="${e.category}">${e.name}</span></li>`;
		}),
		gallery.appendChild(t);
}
function activeFilter() {
	let e = document.querySelectorAll(".nav-link");
	document.addEventListener("DOMContentLoaded", function () {
		let e = document.querySelector('.nav-link[data-images-toggle="Tous"]');
		e.classList.add("active"), e.click();
	}),
		e.forEach((t) => {
			t.addEventListener("click", () => {
				e.forEach((e) => {
					e.classList.remove("active");
				}),
					t.classList.add("active");
			});
		});
}
function createGallery(e) {
	let t = document.createElement("div");
	t.classList.add("gallery-items-row", "row"),
		e.forEach((e) => {
			let a = document.createElement("div");
			a.classList.add(
				"item-column",
				"mb-4",
				"col-12",
				"col-sm-6",
				"col-md-4",
				"col-lg-4",
				"col-xl-4"
			),
				a.setAttribute("data-gallery-tag", e.category);
			let r = document.createElement("img");
			r.classList.add("gallery-item", "img-fluid", e.category, "modal-trigger"),
				r.setAttribute("data-gallery-tag", e.category),
				r.setAttribute("src", e.src),
				r.setAttribute("alt", e.alt),
				r.setAttribute("loading", "lazy"),
				r.addEventListener("click", function () {
					let e = this.getAttribute("src"),
						t = this.getAttribute("alt"),
						a = this.getAttribute("data-gallery-tag");
					openModal(e, t, a);
				}),
				a.appendChild(r),
				t.appendChild(a);
		}),
		gallery.appendChild(t);
}
function showFilter(e, t) {
	t.forEach(function (t) {
		"Tous" === e || t.getAttribute("data-gallery-tag").includes(e)
			? ((t.style.display = "block"), t.classList.add("fade-in"))
			: (t.style.display = "none");
	});
}
function useFilter() {
	let e = document.querySelectorAll(".nav-link");
	e.forEach((e) => {
		let t = e.getAttribute("data-images-toggle");
		e.addEventListener("click", () => {
			currentImageIndex = 0;
			let e = document.querySelector(".gallery-items-row");
			e.parentNode.removeChild(e),
				createGallery(
					(filteredImages = images.filter(
						(e) => e.category === t || "Tous" === t
					))
				);
			let a = document.querySelectorAll(".gallery-item"),
				r = document.querySelectorAll(".item-column");
			showFilter(t, a), showFilter(t, r);
		});
	});
}
createFilter(filters), activeFilter(), createGallery(images), useFilter();
let currentImageIndex = 0,
	currentCategory = "";
function openModal(e, t, a) {
	let r = document.querySelector(".custom-modal"),
		l = document.querySelector(".custom-modal-container"),
		s = document.querySelector("body");
	s.classList.add("modal-open"),
		setTimeout(() => {
			l.classList.add("active");
		}, 50);
	let i = document.createElement("div");
	i.classList.add("custom-modal-content"),
		(i.innerHTML = `
                <div class="modal-body">
                    <span class="arrowModal arrowModalLeft"><</span>
                    <img class="imgModal" src="${e}" alt="${t}" data-gallery-tag="${a}">
					<span class="arrowModal arrowModalRight">></span>
                </div>
			`),
		r.appendChild(i);
	let n = document.querySelector(".overlayModal");
	n.addEventListener("click", closeModal);
	let o = document.querySelector(".arrowModalLeft");
	o.addEventListener("click", showPreviousImage);
	let c = document.querySelector(".arrowModalRight");
	c.addEventListener("click", showNextImage),
		(currentCategory = a),
		(currentImageIndex = findImageIndex(e, a));
}
function findImageIndex(e, t) {
	return filteredImages.findIndex((a) => a.src === e && a.category === t);
}
function showPreviousImage() {
	(currentImageIndex =
		(currentImageIndex - 1 + filteredImages.length) % filteredImages.length),
		console.log("Previous Image Index:", currentImageIndex),
		console.log("Filtered Images Length:", filteredImages.length),
		console.log(
			"Previous Image Source:",
			filteredImages[currentImageIndex].src
		),
		updateModalImage();
}
function showNextImage() {
	(currentImageIndex = (currentImageIndex + 1) % filteredImages.length),
		console.log("Next Image Index:", currentImageIndex),
		console.log("Filtered Images Length:", filteredImages.length),
		console.log("Next Image Source:", filteredImages[currentImageIndex].src),
		updateModalImage();
}
function updateModalImage() {
	let e = document.querySelector(".imgModal");
	(e.src = filteredImages[currentImageIndex].src),
		(e.alt = filteredImages[currentImageIndex].alt),
		e.setAttribute(
			"data-gallery-tag",
			filteredImages[currentImageIndex].category
		);
}
function closeModal() {
	let e = document.querySelector(".custom-modal-content"),
		t = document.querySelector(".custom-modal-container"),
		a = document.querySelector("body");
	a.classList.remove("modal-open"),
		t.classList.remove("active"),
		e.parentNode.removeChild(e);
}
